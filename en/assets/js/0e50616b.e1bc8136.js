"use strict";(self.webpackChunkditsmod_github_io=self.webpackChunkditsmod_github_io||[]).push([[438],{8015:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>a,contentTitle:()=>n,default:()=>h,frontMatter:()=>i,metadata:()=>d,toc:()=>l});var r=t(4848),s=t(5680);const i={sidebar_position:9},n="LogMediator",d={id:"components-of-ditsmod-app/log-mediator",title:"LogMediator",description:"In Ditsmod application, you can substitute the default logger with your own logger, and this will allow you to record in your own way even those messages that are issued in @ditsmod/core. But changing the logger does not allow you to change the text of the messages themselves and the level of logging (trace, debug, info, warn, error). LogMediator (or its child class SystemLogMediator) is used for this. Of course, if you have direct access to the code where the logger writes a certain message, then you can change this message on the spot without LogMediator. And if the message is issued by the Ditsmod framework itself or its modules, LogMediator is essential.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/00-components-of-ditsmod-app/09-log-mediator.md",sourceDirName:"00-components-of-ditsmod-app",slug:"/components-of-ditsmod-app/log-mediator",permalink:"/en/components-of-ditsmod-app/log-mediator",draft:!1,unlisted:!1,editUrl:"https://github.com/ditsmod/ditsmod/edit/main/website/i18n/en/docusaurus-plugin-content-docs/current/00-components-of-ditsmod-app/09-log-mediator.md",tags:[],version:"current",sidebarPosition:9,frontMatter:{sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"Logger",permalink:"/en/components-of-ditsmod-app/logger"},next:{title:"HttpErrorHandler",permalink:"/en/components-of-ditsmod-app/http-error-handler"}},a={},l=[{value:"Extending LogMediator class",id:"extending-logmediator-class",level:2},{value:"Application-level substitute of LogMediator",id:"application-level-substitute-of-logmediator",level:2},{value:"Module-level substitute of LogMediator",id:"module-level-substitute-of-logmediator",level:2}];function c(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,s.RP)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.h1,{id:"logmediator",children:"LogMediator"}),"\n",(0,r.jsxs)(o.p,{children:["In Ditsmod application, you can substitute the default logger with your own logger, and this will allow you to record in your own way even those messages that are issued in ",(0,r.jsx)(o.code,{children:"@ditsmod/core"}),". But changing the logger does not allow you to change the text of the messages themselves and the level of logging (trace, debug, info, warn, error). ",(0,r.jsx)(o.code,{children:"LogMediator"})," (or its child class ",(0,r.jsx)(o.code,{children:"SystemLogMediator"}),") is used for this. Of course, if you have direct access to the code where the logger writes a certain message, then you can change this message on the spot without ",(0,r.jsx)(o.code,{children:"LogMediator"}),". And if the message is issued by the Ditsmod framework itself or its modules, ",(0,r.jsx)(o.code,{children:"LogMediator"})," is essential."]}),"\n",(0,r.jsxs)(o.p,{children:["If you want to write a module for a Ditsmod application to publish on, for example, npmjs.com, it is recommended that you use ",(0,r.jsx)(o.code,{children:"LogMediator"})," instead of ",(0,r.jsx)(o.code,{children:"Logger"}),", as users will be able to modify the messages that your module writes."]}),"\n",(0,r.jsxs)(o.p,{children:["The Ditsmod repository has an example ",(0,r.jsx)(o.a,{href:"https://github.com/ditsmod/ditsmod/tree/main/examples/11-override-core-log-messages",children:"11-override-core-log-messages"})," that demonstrates several uses of ",(0,r.jsx)(o.code,{children:"LogMediator"}),". To try this example, you can first clone the repository and install the dependencies:"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-bash",children:"git clone https://github.com/ditsmod/ditsmod.git\ncd ditsmod\nnpm i\ncd examples/11-override-core-log-messages\nnpm start\n"})}),"\n",(0,r.jsx)(o.p,{children:"After that, you can directly view and experiment with this example in your editor."}),"\n",(0,r.jsx)(o.h2,{id:"extending-logmediator-class",children:"Extending LogMediator class"}),"\n",(0,r.jsxs)(o.p,{children:["Since this example extends the class, it uses the recommended TypeScript setting in ",(0,r.jsx)(o.code,{children:"tsconfig.json"}),":"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-json",children:'{\n  "compilerOptions": {\n    // ...\n    "noImplicitOverride": true,\n    // ...\n  },\n  // ...\n}\n'})}),"\n",(0,r.jsxs)(o.p,{children:["This feature has been available in TypeScript since version 4.3, it allows you to make your code more readable by not allowing you to override properties and methods of the parent class without the word ",(0,r.jsx)(o.code,{children:"override"}),". On the other hand, if a method that is ",(0,r.jsx)(o.code,{children:"override"})," marked in the child class disappears in the parent class, TypeScript will also throw an error with the corresponding hint."]}),"\n",(0,r.jsxs)(o.p,{children:["Now let's take a look at ",(0,r.jsx)(o.code,{children:"MyLogMediator"}),":"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-ts",children:'import { SystemLogMediator, InputLogFilter } from \'@ditsmod/core\';\n\nexport class MyLogMediator extends SystemLogMediator {\n  /**\n   * Here host: "${host}", and here port: "${port}"\n   */\n  override serverListen(self: object, host: string, port: number) {\n    const className = self.constructor.name;\n    const inputLogFilter = new InputLogFilter();\n    inputLogFilter.className = className;\n    this.setLog(\'info\', inputLogFilter, `Here host: "${host}", and here port: "${port}"`);\n  }\n}\n'})}),"\n",(0,r.jsxs)(o.p,{children:["As you can see, ",(0,r.jsx)(o.code,{children:"MyLogMediator"})," extends ",(0,r.jsx)(o.code,{children:"LogMediator"})," and the ",(0,r.jsx)(o.code,{children:"serverListen()"})," method is marked with the ",(0,r.jsx)(o.code,{children:"override"})," keyword because it overrides a parent method with the exact same name. The text of the message that will be recorded in the logs is written in the comments to the method. Almost all ",(0,r.jsx)(o.code,{children:"SystemLogMediator"})," methods pass ",(0,r.jsx)(o.code,{children:"this"})," of the class instance where ",(0,r.jsx)(o.code,{children:"SystemLogMediator"})," is used as the first argument, so that you can easily get the name of that class. The rest of the arguments are arbitrary, everything depends on the context of using these methods."]}),"\n",(0,r.jsxs)(o.p,{children:["The result can be seen if you run the application with the ",(0,r.jsx)(o.code,{children:"npm start"})," command, after which you should receive exactly the message that was generated in this ",(0,r.jsx)(o.code,{children:"myLogMediator.serverListen()"})," method."]}),"\n",(0,r.jsx)(o.h2,{id:"application-level-substitute-of-logmediator",children:"Application-level substitute of LogMediator"}),"\n",(0,r.jsxs)(o.p,{children:["If you look at ",(0,r.jsx)(o.code,{children:"AppModule"}),", you can see how ",(0,r.jsx)(o.code,{children:"LogMediator"})," is substituted by ",(0,r.jsx)(o.code,{children:"MyLogMediator"}),":"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-ts",metastring:"{8-9}",children:"import { SystemLogMediator, rootModule } from '@ditsmod/core';\n\nimport { MyLogMediator } from './my-log-mediator.js';\n\n@rootModule({\n// ...\n  providersPerApp: [\n    { token: SystemLogMediator, useClass: MyLogMediator },\n    MyLogMediator,\n  ],\n})\nexport class AppModule {}\n"})}),"\n",(0,r.jsxs)(o.p,{children:["In this case, the first element of the array ",(0,r.jsx)(o.code,{children:"providersPerApp"})," will allow using ",(0,r.jsx)(o.code,{children:"MyLogMediator"})," in the Ditsmod core code, the second element - will allow requesting the instance of ",(0,r.jsx)(o.code,{children:"MyLogMediator"})," in the constructors of controllers or services of your application."]}),"\n",(0,r.jsxs)(o.p,{children:["Keep in mind that such an application-level substitution works without additional settings only in the root module. If you do this in a non-root module, you will additionally have ",(0,r.jsx)(o.a,{href:"/developer-guides/providers-collisions/",children:"to resolve the provider collision"})," in the root module (although this is quite simple)."]}),"\n",(0,r.jsx)(o.h2,{id:"module-level-substitute-of-logmediator",children:"Module-level substitute of LogMediator"}),"\n",(0,r.jsxs)(o.p,{children:["As mentioned at the beginning, if you plan to publish your module to other users, it is recommended to use ",(0,r.jsx)(o.code,{children:"LogMediator"})," instead of ",(0,r.jsx)(o.code,{children:"Logger"}),". In this case, users will be able to change the messages written by your module."]}),"\n",(0,r.jsxs)(o.p,{children:["To change messages from an external service, ",(0,r.jsx)(o.code,{children:"SomeLogMediator"})," has been extended in ",(0,r.jsx)(o.code,{children:"OtherModule"})," and the method that works in ",(0,r.jsx)(o.code,{children:"SomeService"})," has been overrided. After that, ",(0,r.jsx)(o.code,{children:"SomeLogMediator"})," was substituted to ",(0,r.jsx)(o.code,{children:"OtherLogMediator"}),":"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-ts",children:"import { featureModule } from '@ditsmod/core';\n\nimport { SomeModule } from '../some/some.module.js';\nimport { SomeLogMediator } from '../some/some-log-mediator.js';\nimport { OtherController } from './other.controller.js';\nimport { OtherLogMediator } from './other-log-mediator.js';\n\n@featureModule({\n  imports: [SomeModule],\n  controllers: [OtherController],\n  providersPerMod: [{ token: SomeLogMediator, useClass: OtherLogMediator }],\n})\nexport class OtherModule {}\n"})})]})}function h(e={}){const{wrapper:o}={...(0,s.RP)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},5680:(e,o,t)=>{t.d(o,{RP:()=>l});var r=t(6540);function s(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function i(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);o&&(r=r.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,r)}return t}function n(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?i(Object(t),!0).forEach((function(o){s(e,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}))}return e}function d(e,o){if(null==e)return{};var t,r,s=function(e,o){if(null==e)return{};var t,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],o.indexOf(t)>=0||(s[t]=e[t]);return s}(e,o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],o.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var a=r.createContext({}),l=function(e){var o=r.useContext(a),t=o;return e&&(t="function"==typeof e?e(o):n(n({},o),e)),t},c={inlineCode:"code",wrapper:function(e){var o=e.children;return r.createElement(r.Fragment,{},o)}},h=r.forwardRef((function(e,o){var t=e.components,s=e.mdxType,i=e.originalType,a=e.parentName,h=d(e,["components","mdxType","originalType","parentName"]),m=l(t),u=s,p=m["".concat(a,".").concat(u)]||m[u]||c[u]||i;return t?r.createElement(p,n(n({ref:o},h),{},{components:t})):r.createElement(p,n({ref:o},h))}));h.displayName="MDXCreateElement"}}]);