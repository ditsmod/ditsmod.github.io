"use strict";(self.webpackChunkditsmod_github_io=self.webpackChunkditsmod_github_io||[]).push([[7],{6266:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>a,metadata:()=>i,toc:()=>u});var o=r(3117),n=(r(7294),r(3905));const a={},s="03-route-guards",i={unversionedId:"examples/route-guards",id:"examples/route-guards",title:"03-route-guards",description:"To try this example, you should first prepare the prerequisite.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/10-examples/03-route-guards.md",sourceDirName:"10-examples",slug:"/examples/route-guards",permalink:"/en/examples/route-guards",draft:!1,editUrl:"https://github.com/ditsmod/ditsmod/edit/main/website/i18n/en/docusaurus-plugin-content-docs/current/10-examples/03-route-guards.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"02-controller-error-handler",permalink:"/en/examples/controller-error-handler"},next:{title:"04-logger",permalink:"/en/examples/logger"}},l={},u=[],p={toc:u};function c(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,o.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"03-route-guards"},"03-route-guards"),(0,n.kt)("p",null,"To try this example, you should first ",(0,n.kt)("a",{parentName:"p",href:"/examples/prerequisite"},"prepare the prerequisite"),"."),(0,n.kt)("p",null,"In this example, ",(0,n.kt)("inlineCode",{parentName:"p"},"SomeModule")," is imported into the root module, which has a controller with protected routes. Protection of these routes takes place with the help of ",(0,n.kt)("a",{parentName:"p",href:"/components-of-ditsmod-app/guards"},"guards"),". These guards are in ",(0,n.kt)("inlineCode",{parentName:"p"},"AuthModule"),", and the module itself is exported from the root module. Exporting modules only applies to providers for DI. There's no point in exporting modules if you don't need providers from them."),(0,n.kt)("p",null,"However, if you ",(0,n.kt)("a",{parentName:"p",href:"/components-of-ditsmod-app/exports-and-imports#export-of-the-providers-from-the-root-module"},"export a specific module from the root module"),", its providers are copied to every application module. This is exactly what happens in the ",(0,n.kt)("inlineCode",{parentName:"p"},"AuthModule")," module."),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"SomeController")," shows two options for using guards. The first option without arguments:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},"@route('GET', 'unauth', [AuthGuard])\nthrow401Error(res: Res) {\n  res.send('some secret');\n}\n")),(0,n.kt)("p",null,"The second option with arguments:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},"@route('GET', 'forbidden', [[PermissionsGuard, Permission.canActivateAdministration]])\nthrow403Error(res: Res) {\n  res.send('some secret');\n}\n")),(0,n.kt)("p",null,"You can run the application from the first terminal:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"yarn start3\n")),(0,n.kt)("p",null,"From the second terminal check the work:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"curl -isS localhost:3000\ncurl -isS localhost:3000/unauth\ncurl -isS localhost:3000/forbidden\n")))}c.isMDXComponent=!0},3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var o=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=o.createContext({}),u=function(e){var t=o.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},p=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=u(r),m=n,h=d["".concat(l,".").concat(m)]||d[m]||c[m]||a;return r?o.createElement(h,s(s({ref:t},p),{},{components:r})):o.createElement(h,s({ref:t},p))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,s=new Array(a);s[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:n,s[1]=i;for(var u=2;u<a;u++)s[u]=r[u];return o.createElement.apply(null,s)}return o.createElement.apply(null,r)}d.displayName="MDXCreateElement"}}]);