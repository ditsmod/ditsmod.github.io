<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-components-of-ditsmod-app/controllers-and-services" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Router, controllers and services | Ditsmod</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ditsmod.github.io/en/components-of-ditsmod-app/controllers-and-services/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="uk"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Router, controllers and services | Ditsmod"><meta data-rh="true" name="description" content="What does a router do?"><meta data-rh="true" property="og:description" content="What does a router do?"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ditsmod.github.io/en/components-of-ditsmod-app/controllers-and-services/"><link data-rh="true" rel="alternate" href="https://ditsmod.github.io/en/components-of-ditsmod-app/controllers-and-services/" hreflang="en"><link data-rh="true" rel="alternate" href="https://ditsmod.github.io/components-of-ditsmod-app/controllers-and-services/" hreflang="uk"><link data-rh="true" rel="alternate" href="https://ditsmod.github.io/components-of-ditsmod-app/controllers-and-services/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KXSV6YPHSY-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JB9Z2HZH02"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JB9Z2HZH02",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Ditsmod" href="/en/opensearch.xml"><link rel="stylesheet" href="/en/assets/css/styles.5e447fbd.css">
<script src="/en/assets/js/runtime~main.6ee8d2bd.js" defer="defer"></script>
<script src="/en/assets/js/main.22d1b346.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="Ditsmod Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/en/img/logo.svg" alt="Ditsmod Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Home</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ditsmod/ditsmod" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/en/components-of-ditsmod-app/controllers-and-services/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/components-of-ditsmod-app/controllers-and-services/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="uk">Українська</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/en/components-of-ditsmod-app/module/">Components of Ditsmod app</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/components-of-ditsmod-app/module/">Modules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/components-of-ditsmod-app/controllers-and-services/">Router, controllers and services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/components-of-ditsmod-app/dependency-injection/">Dependency Injection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/components-of-ditsmod-app/http-interceptors/">HTTP Interceptors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/components-of-ditsmod-app/guards/">Guards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/components-of-ditsmod-app/extensions/">Extensions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/components-of-ditsmod-app/logger/">Logger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/components-of-ditsmod-app/log-mediator/">LogMediator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/components-of-ditsmod-app/http-error-handler/">HttpErrorHandler</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/components-of-ditsmod-app/module-manager/">ModuleManager</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/developer-guides/exports-and-imports/">Developer guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/native-modules/routing/">Native Ditsmod modules</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Components of Ditsmod app</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Router, controllers and services</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1 id="router-controllers-and-services">Router, controllers and services</h1>
<h2 id="what-does-a-router-do">What does a router do?</h2>
<p>The router has a mapping between the URL and the corresponding request handler. Although you will not have to manually write this mapping, but for a general idea of how the router works, in a very simplified form, this mapping can be imagined as follows:</p>
<pre><code class="language-ts">const routes = new Map&lt;string, Function&gt;();
routes.set(&#x27;/one&#x27;, function() { /** request processing... **/ });
routes.set(&#x27;/two&#x27;, function() { /** request processing... **/ });
routes.set(&#x27;/three&#x27;, function() { /** request processing... **/ });
// ...
</code></pre>
<p>Right after Node.js receives an HTTP request and passes it to Ditsmod, the request URL is split into two parts separated by a question mark (if present). The first part always contains the so-called <em>path</em>, while the second part contains the <em>query parameters</em>, if the URL included a question mark.</p>
<p>The router&#x27;s task is to find the HTTP request handler by <em>path</em> and invoke it. In a very simplified form, this process can be imagined as follows:</p>
<pre><code class="language-ts">const path = &#x27;/two&#x27;;
const handle = routes.get(path);
if (handle) {
  handle();
}
</code></pre>
<p>In most cases, the request handler calls the controller method.</p>
<h2 id="what-is-a-controller">What is a controller</h2>
<p>The mapping between the URL and the request handler is based on the metadata attached to the controller methods. A TypeScript class becomes a Ditsmod controller thanks to the <code>controller</code> decorator:</p>
<pre><code class="language-ts">import { controller } from &#x27;@ditsmod/core&#x27;;

@controller()
export class SomeController {}
</code></pre>
<p>It is recommended that controller files end with <code>*.controller.ts</code> and their class names end with <code>*Controller</code>.</p>
<p>Starting with v2.50.0, Ditsmod makes it possible to work with the controller in two modes:</p>
<ol>
<li>Controller non-singleton (by default). Its instance is created for each HTTP request.</li>
<li>Controller <a href="https://en.wikipedia.org/wiki/Singleton_pattern">singleton</a>. It is instantiated once at the module level during application initialization.</li>
</ol>
<p>The first mode is safer when you need to work in the context of the current HTTP request (the client provides a certain identifier that must be taken into account to form a response). The second mode is noticeably faster (about 15%) and consumes less memory, but the request context cannot be stored in the properties of the controller instance, because this instance can be used for other clients at the same time. In the second mode, the request context will have to be passed only as an argument to the methods.</p>
<p>In order for Ditsmod to work with the controller as a singleton, <code>{ isSingleton: true }</code> must be specified in the metadata:</p>
<pre><code class="language-ts">import { controller } from &#x27;@ditsmod/core&#x27;;

@controller({ isSingleton: true })
export class SomeController {}
</code></pre>
<h3 id="the-controller-non-singleton">The controller non-singleton</h3>
<p>As mentioned above, after the router finds the HTTP request handler, this handler can call the controller method. To make this possible, HTTP requests are first bound to controller methods through a routing system using the <code>route</code> decorator. In the following example, a single route is created that accepts a <code>GET</code> request at the path <code>/hello</code>:</p>
<pre><code class="language-ts" metastring="{5}">import { controller, route, Res } from &#x27;@ditsmod/core&#x27;;

@controller()
export class HelloWorldController {
  @route(&#x27;GET&#x27;, &#x27;hello&#x27;)
  method1(res: Res) {
    res.send(&#x27;Hello World!&#x27;);
  }
}
</code></pre>
<p>What we see here:</p>
<ol>
<li>The route is created using the <code>route</code> decorator, which is placed in front of the class method, and it does not matter what the name of this method is.</li>
<li>In the class method, the parameter <code>res</code> is declared with the data type <code>Res</code>. So we ask Ditsmod to create an instance of the <code>Res</code> class and pass it to the corresponding variable. By the way, <code>res</code> is short for the word <em>response</em>.</li>
<li>Text responses to HTTP requests are sent via <code>res.send()</code>.</li>
</ol>
<p>Although in the previous example, an instance of the <code>Res</code> class was requested through <code>method1</code>, we can similarly request this instance in the constructor:</p>
<pre><code class="language-ts" metastring="{5}">import { controller, route, Res } from &#x27;@ditsmod/core&#x27;;

@controller()
export class HelloWorldController {
  constructor(private res: Res) {}

  @route(&#x27;GET&#x27;, &#x27;hello&#x27;)
  method1() {
    this.res.send(&#x27;Hello World!&#x27;);
  }
}
</code></pre>
<p>Of course, other instances of classes can be requested in the parameters, and the order of the parameters is not important.</p>
<admonition title="Use the access modifier" type="tip"><p>The access modifier in the constructor can be any (private, protected or public), but without a modifier - <code>res</code> will be just a simple parameter with visibility only in the constructor.</p></admonition>
<p>To obtain <code>pathParams</code> or <code>queryParams</code>, we need to use the <code>inject</code> decorator and the <code>PATH_PARAMS</code> and <code>QUERY_PARAMS</code> tokens:</p>
<pre><code class="language-ts" metastring="{7-8}">import { controller, Res, route, inject, AnyObj, PATH_PARAMS, QUERY_PARAMS } from &#x27;@ditsmod/core&#x27;;

@controller()
export class SomeController {
  @route(&#x27;POST&#x27;, &#x27;some-url/:param1/:param2&#x27;)
  postSomeUrl(
    @inject(PATH_PARAMS) pathParams: AnyObj,
    @inject(QUERY_PARAMS) queryParams: AnyObj,
    res: Res
  ) {
    res.sendJson({ pathParams, queryParams });
  }
}
</code></pre>
<p>You can find more information about what a token is and what the <code>inject</code> decorator does in the <a href="/components-of-ditsmod-app/dependency-injection#dependency-token">Dependency Injection</a> section.</p>
<p>As you can see from the previous example, to send responses with objects, you need to use the <code>res.sendJson()</code> method instead of <code>res.send()</code> (which only sends text).</p>
<p>Native Node.js request and response objects can be obtained by tokens, respectively - <code>NODE_REQ</code> and <code>NODE_RES</code>:</p>
<pre><code class="language-ts" metastring="{6-7}">import { controller, route, inject, NODE_REQ, NODE_RES, NodeRequest, NodeResponse } from &#x27;@ditsmod/core&#x27;;

@controller()
export class HelloWorldController {
  constructor(
    @inject(NODE_REQ) private nodeReq: NodeRequest,
    @inject(NODE_RES) private nodeRes: NodeResponse
  ) {}

  @route(&#x27;GET&#x27;, &#x27;hello&#x27;)
  method1() {
    this.nodeRes.end(&#x27;Hello World!&#x27;);
  }
}
</code></pre>
<p>You may also be interested in <a href="/native-modules/body-parser#usage">how to get the HTTP request body</a>.</p>
<h3 id="the-controller-singleton">The controller singleton</h3>
<p>Because the controller is instantiated in this mode only once, you will not be able to query in its constructor for class instances that are instantiated on each request. For example, if you request an instance of the <code>Res</code> class in the constructor, Ditsmod will throw an error:</p>
<pre><code class="language-ts" metastring="{3,5}">import { controller, route, Res } from &#x27;@ditsmod/core&#x27;;

@controller({ isSingleton: true })
export class HelloWorldController {
  constructor(private res: Res) {}

  @route(&#x27;GET&#x27;, &#x27;hello&#x27;)
  method1() {
    this.res.send(&#x27;Hello World!&#x27;);
  }
}
</code></pre>
<p>The working case will be as follows:</p>
<pre><code class="language-ts" metastring="{3,6}">import { controller, route, RequestContext } from &#x27;@ditsmod/core&#x27;;

@controller({ isSingleton: true })
export class HelloWorldController {
  @route(&#x27;GET&#x27;, &#x27;hello&#x27;)
  method1(ctx: RequestContext) {
    ctx.nodeRes.setHeader(&#x27;Content-Type&#x27;, &#x27;text/plain; charset=utf-8&#x27;);
    ctx.nodeRes.end(&#x27;Hello, World!&#x27;);
  }
}
</code></pre>
<p>Where <code>ctx.nodeRes</code> is the native Node.js response object.</p>
<p>In the &quot;controller singleton&quot; mode, controller methods bound to specific routes receive a single argument - the request context. That is, in this mode, you will no longer be able to ask Ditsmod to pass instances of other classes to these methods. However, in the constructor you can still request instances of certain classes that are created only once.</p>
<h2 id="binding-of-the-controller-to-the-module">Binding of the controller to the module</h2>
<p>The controller is bound to the module through the <code>controllers</code> array:</p>
<pre><code class="language-ts" metastring="{5}">import { featureModule } from &#x27;@ditsmod/core&#x27;;
import { SomeController } from &#x27;./some.controller.js&#x27;;

@featureModule({
  controllers: [SomeController]
})
export class SomeModule {}
</code></pre>
<p>After binding controllers to a module, in order for Ditsmod to take these controllers into account, the module should be either appended or imported as an object that has the <a href="/developer-guides/exports-and-imports#ModuleWithParams">ModuleWithParams</a> interface. The following example shows both the appending and the full import of the module (this is just to demonstrate the possibility, in practice it does not make sense to append and import at the same time):</p>
<pre><code class="language-ts" metastring="{5-7}">import { featureModule } from &#x27;@ditsmod/core&#x27;;
import { SomeModule } from &#x27;./some.module.js&#x27;;

@featureModule({
  appends: [SomeModule],
  // OR
  imports: [{ path: &#x27;some-prefix&#x27;, module: SomeModule }]
})
export class OtherModule {}
</code></pre>
<p>If the module is imported without the <code>path</code> property, Ditsmod will only import <a href="/components-of-ditsmod-app/dependency-injection#providers">providers</a> and <a href="/components-of-ditsmod-app/extensions/">extensions</a> from it:</p>
<pre><code class="language-ts" metastring="{5}">import { featureModule } from &#x27;@ditsmod/core&#x27;;
import { SomeModule } from &#x27;./some.module.js&#x27;;

@featureModule({
  imports: [SomeModule]
})
export class OtherModule {}
</code></pre>
<p>You can read more detailed information in the section <a href="/developer-guides/exports-and-imports#import-module">Export, import and appends of modules</a>.</p>
<h2 id="services">Services</h2>
<p>While it&#x27;s technically possible to get by with just one controller to handle an HTTP request, it&#x27;s better to separate the extensive business logic code into separate classes so that the code can be reused as needed and is easier to test. These separate classes with business logic are usually called <em>services</em>.</p>
<p>What services can do:</p>
<ul>
<li>provide configuration;</li>
<li>validate the request;</li>
<li>parsing the request body;</li>
<li>check access rights;</li>
<li>work with databases, with email;</li>
<li>etc.</li>
</ul>
<p>Any TypeScript class can be a Ditsmod service, but if you want <a href="/components-of-ditsmod-app/dependency-injection">DI</a> to resolve the dependency you specify in the constructors of these classes, you must specify the <code>injectable</code> decorator before them:</p>
<pre><code class="language-ts" metastring="{4,6}">import { injectable } from &#x27;@ditsmod/core&#x27;;
import { FirstService } from &#x27;./first.service.js&#x27;;

@injectable()
export class SecondService {
  constructor(private firstService: FirstService) {}

  methodOne() {
    this.firstService.doSomeThing();
  }
}
</code></pre>
<p>It is recommended that service files end with <code>*.service.ts</code>, and their classes end with <code>*Service</code>.</p>
<p>As you can see, the rules for getting a class instance in the constructor are the same as in controllers: using the <code>private</code> access modifier, we declare a property of the <code>firstService</code> class with the <code>FirstService</code> data type.</p>
<p>To be able to use the newly created service classes, they must be passed in the metadata of the <strong>current</strong> module or controller. You can pass the services in the module metadata as follows:</p>
<pre><code class="language-ts" metastring="{7-8}">import { featureModule } from &#x27;@ditsmod/core&#x27;;
import { FirstService } from &#x27;./first.service.js&#x27;;
import { SecondService } from &#x27;./second.service.js&#x27;;

@featureModule({
  providersPerReq: [
    FirstService,
    SecondService
  ],
})
export class SomeModule {}
</code></pre>
<p>Similarly, the services is passed in the controller metadata:</p>
<pre><code class="language-ts" metastring="{7-8}">import { controller, route, Res } from &#x27;@ditsmod/core&#x27;;
import { FirstService } from &#x27;./first.service.js&#x27;;
import { SecondService } from &#x27;./second.service.js&#x27;;

@controller({
  providersPerReq: [
    FirstService,
    SecondService
  ],
})
export class SomeController {
  @route(&#x27;GET&#x27;, &#x27;hello&#x27;)
  method1(res: Res, secondService: SecondService) {
    res.send(secondService.sayHello());
  }
}
</code></pre>
<p>In the last two examples, the services is passed to the <code>providersPerReq</code> array, but this is not the only way to pass services. For more information about the rules of working with DI, see <a href="/components-of-ditsmod-app/dependency-injection">Dependency Injection</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ditsmod/ditsmod/edit/main/website/i18n/en/docusaurus-plugin-content-docs/current/00-components-of-ditsmod-app/01-controllers-and-services.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/components-of-ditsmod-app/module/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Modules</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/components-of-ditsmod-app/dependency-injection/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Dependency Injection</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-does-a-router-do" class="table-of-contents__link toc-highlight">What does a router do?</a></li><li><a href="#what-is-a-controller" class="table-of-contents__link toc-highlight">What is a controller</a><ul><li><a href="#the-controller-non-singleton" class="table-of-contents__link toc-highlight">The controller non-singleton</a></li><li><a href="#the-controller-singleton" class="table-of-contents__link toc-highlight">The controller singleton</a></li></ul></li><li><a href="#binding-of-the-controller-to-the-module" class="table-of-contents__link toc-highlight">Binding of the controller to the module</a></li><li><a href="#services" class="table-of-contents__link toc-highlight">Services</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/ditsmod" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ditsmod" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/ditsmod/ditsmod" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>